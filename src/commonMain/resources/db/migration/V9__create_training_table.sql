CREATE TABLE IF NOT EXISTS trainings (id INT AUTO_INCREMENT PRIMARY KEY, template_id INT NOT NULL, create_date_in_millis DATETIME(6) NOT NULL, finish_date_in_millis DATETIME(6) NOT NULL, user_id INT NOT NULL, CONSTRAINT fk_trainings_template_id_id FOREIGN KEY (template_id) REFERENCES training_templates(id) ON UPDATE RESTRICT, CONSTRAINT fk_trainings_user_id_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE RESTRICT);
CREATE TABLE IF NOT EXISTS series (id INT AUTO_INCREMENT PRIMARY KEY, `date` DATETIME(6) NOT NULL, burden INT NULL, time_in_millis BIGINT NULL, reps_number INT NULL, note TEXT NOT NULL, user_id INT NOT NULL, CONSTRAINT fk_series_user_id_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE RESTRICT);
CREATE TABLE IF NOT EXISTS exercise_with_progress (id INT AUTO_INCREMENT PRIMARY KEY, exercise_id INT NOT NULL, user_id INT NOT NULL, CONSTRAINT fk_exercise_with_progress_exercise_id_id FOREIGN KEY (exercise_id) REFERENCES exercises(id) ON UPDATE RESTRICT, CONSTRAINT fk_exercise_with_progress_user_id_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE RESTRICT);
CREATE TABLE IF NOT EXISTS training_to_exercise (id INT AUTO_INCREMENT PRIMARY KEY, training_id INT NOT NULL, exercise_id INT NOT NULL, CONSTRAINT fk_training_to_exercise_training_id_id FOREIGN KEY (training_id) REFERENCES trainings(id) ON DELETE CASCADE ON UPDATE RESTRICT, CONSTRAINT fk_training_to_exercise_exercise_id_id FOREIGN KEY (exercise_id) REFERENCES exercise_with_progress(id) ON DELETE CASCADE ON UPDATE RESTRICT);
CREATE TABLE IF NOT EXISTS exercise_to_series (id INT AUTO_INCREMENT PRIMARY KEY, exercise_id INT NOT NULL, series_id INT NOT NULL, CONSTRAINT fk_exercise_to_series_exercise_id_id FOREIGN KEY (exercise_id) REFERENCES exercise_with_progress(id) ON DELETE CASCADE ON UPDATE RESTRICT, CONSTRAINT fk_exercise_to_series_series_id_id FOREIGN KEY (series_id) REFERENCES series(id) ON DELETE CASCADE ON UPDATE RESTRICT);